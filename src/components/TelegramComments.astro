---
export interface Props {
  tgPostId?: number
}

const { tgPostId } = Astro.props;
---
<!--{tgPostId && <div class="mt-8">
  <script
    async
    src="https://telegram.org/js/telegram-widget.js?22"
    data-telegram-discussion={`notkifyi/${tgPostId}`}
    data-dark={dark}
    data-comments-limit="5"></script>
</div>
}-->


{tgPostId && (
  <div class="mt-8" id="telegram-comments"
  data-post-id={tgPostId}
  ></div>
  <script>
    if (document) {
      const root = document.getElementById("telegram-comments");

      if (root) {
        const tgPostId = root.getAttribute("data-post-id");
        const dark =
          document.documentElement.getAttribute("data-theme") === "dark" ? 1 : 0;

        const script = document.createElement("script");
        script.async = true;
        script.src = "https://telegram.org/js/telegram-widget.js?22";
        script.setAttribute("data-telegram-discussion", `notkifyi/${tgPostId}`);
        script.setAttribute("data-dark", String(dark));
        script.setAttribute("data-comments-limit", "5");

        root.appendChild(script);
      }
    }
  </script>

  )}
